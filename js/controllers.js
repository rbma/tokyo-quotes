// Generated by CoffeeScript 1.7.1
'use strict';
var quoteControllers;

quoteControllers = angular.module('quoteControllers', []);

quoteControllers.controller('IndexCtrl', [
  '$scope', '$window', '$http', '$sce', 'contentfulClient', function($scope, $window, $http, $sce, contentfulClient) {
    var converter, hideVideo, showVideo;
    converter = new Showdown.converter();
    $scope.body = {};
    $scope.videoStopped = false;
    $scope.begin = true;
    $scope.player = {};
    $scope.background = {};
    $scope.reload = function() {
      return window.location.reload();
    };
    $scope.playing = false;
    $scope.showInfo = false;
    showVideo = function() {
      return $(".video-wrapper").removeClass("hidden");
    };
    hideVideo = function() {
      return $(".video-wrapper").addClass("hidden");
    };
    $scope.playerVars = {
      controls: 0,
      autoplay: 0,
      modestbranding: 1,
      showinfo: 0,
      hd: 1,
      enablejsapi: 1,
      origin: '*'
    };
    $scope.$on('youtube.player.ready', function($event, player) {
      return $scope.player = player;
    });
    $scope.$on('youtube.player.ended', function($event, player) {
      $scope.playing = false;
      $scope.showInfo = true;
      return hideVideo();
    });
    $scope.$watch('playing', function(value) {
      return console.log(value);
    });
    $scope.$watch('player', function(value) {});
    return contentfulClient.entries({
      'content_type': '3NIaEMnF5CcQOCUeUaGESy',
      'include': 1
    }).then(function(data) {
      var quote, quoteCollection, _i, _len, _ref;
      $scope.data = data[0];
      $scope.body = $scope.data.fields;
      $scope.background = $scope.body.bodyImage.fields.file.url;
      $scope.$watch('background', function(value) {});
      _ref = $scope.body.individualQuote;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        quote = _ref[_i];
        quote.fields.artistText = converter.makeHtml(quote.fields.artistText);
      }
      quoteCollection = $scope.body.individualQuote;
      $scope.current = quoteCollection[0];
      $scope.launchVid = function(quote) {
        var video;
        $scope.playing = true;
        showVideo();
        video = quote.fields.youtubeId;
        $scope.player.loadVideoById(video);
        $scope.titleName = quote.fields.titleName;
        return $scope.artistText = quote.fields.artistText;
      };
      $scope.closeInfo = function() {
        return $scope.showInfo = false;
      };
      $scope.updateInfo = function(quote) {
        return $scope.current = quote;
      };
      return $scope.trust = function(text) {
        return $sce.trustAsHtml(text);
      };
    });
  }
]);
